{"formerly":"M3218","seq":"1,4,4,0,4,8,0,0,4,4,8,0,0,8,0,0,4,8,4,0,8,0,0,0,0,12,8,0,0,8,0,0,4,0,8,0,4,8,0,0,8,8,0,0,0,8,0,0,0,4,12,0,8,8,0,0,0,0,8,0,0,8,0,0,4,16,0,0,8,0,0,0,4,8,8,0,0,0,0,0,8,4,8,0,0,16,0,0,0,8,8,0,0,0,0,0,0,8,4,0,12,8","description":"Theta series of square lattice (or number of ways of writing n as a sum of 2 squares).","comments":"Number of points in square lattice on the circle of radius sqrt(n).Often denoted by r(n) or r_2(n).Let b(n)=A004403(n), then sum(k=1..n, a(k)*b(n-k) ) = 1. - _John W. Layman_Theta series of D_2 lattice.Let s = 16*q*(E1*E4^2/E2^3)^8 where Ek = prod(n>=1, 1-q^(k*n) ) (s=k^2 where k is elliptic k), then the g.f. is hypergeom([+1/2, +1/2], [+1], s) (expansion of 2/Pi*ellipticK(k) in powers of q).  - _Joerg Arndt_, Aug 15 2011Number 6 of the 74 eta-quotients listed in Table I of Martin 1996.Ramanujan theta functions: f(q) (see A121373), phi(q) (A000122), psi(q) (A010054), chi(q) (A000700).The zeros in this sequence correspond to those integers with an equal number of 4k+1 and 4k+3 divisors, or equivalently to those that have at least one 4k+3 prime factor with an odd exponent. - _Ant King_, Mar 12 2013If A(q) = 1 + 4*q + 4*q^2 + 4*q^4 + 8*q^5 + ... denotes the o.g.f. of this sequence then the function F(q) := 1/4*(A(q^2) - A(q^4)) = ( sum {n >= 0} q^(2*n+1)^2 )^2 is the o.g.f. for counting the number of ways a positive integer n can be written as the sum of two positive odd squares. - _Peter Bala_, Dec 13 2013","references":["L. Comtet, Advanced Combinatorics, Reidel, 1974, p. 162, #16 (7), r(n).","J. H. Conway and N. J. A. Sloane, \"Sphere Packings, Lattices and Groups\", Springer-Verlag, p. 106.","N. J. Fine, Basic Hypergeometric Series and Applications, Amer. Math. Soc., 1988; p. 78, Eq. (32.23).","E. Grosswald, Representations of Integers as Sums of Squares. Springer-Verlag, NY, 1985.","G. H. Hardy and E. M. Wright, An Introduction to the Theory of Numbers. 3rd ed., Oxford Univ. Press, 1954, p. 240, r(n).","C. D. Olds, A. Lax and G. P. Davidoff, The Geometry of Numbers, Math. Assoc. Amer., 2000, p. 51.","N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence)."],"links":["T. D. Noe, <a href=\"/A004018/b004018.txt\">Table of n, a(n) for n = 0..10000</a>","G. E. Andrews, R. Lewis and Z.-G. Liu, <a href=\"http://dx.doi.org/10.1112/blms/33.1.25\">An identity relating a theta series to a sum of Lambert series</a>, Bull. London Math. Soc., 33 (2001), 25-31.","H. H. Chan and C. Krattenthaler, <a href=\"http://arXiv.org/abs/math.NT/0407061\">Recent progress in the study of representations of integers as sums of squares</a>, arXiv:math/0407061 [math.NT], 2004.","S. Cooper and M. Hirschhorn, <a href=\"http://www.emis.de/journals/INTEGERS/papers/e9/e9.Abstract.html\">A combinatorial proof of a result from number theory</a>, Integers 4 (2004), #A09.","Michael Gilleland, <a href=\"/selfsimilar.html\">Some Self-Similar Integer Sequences</a>","M. D. Hirschhorn, <a href=\"http://web.maths.unsw.edu.au/~mikeh/webpapers/paper58.pdf\">Jacobi's Two-Square Theorem and Related Identities</a>","M. D. Hirschhorn, <a href=\"http://web.maths.unsw.edu.au/~mikeh/webpapers/paper67.pdf\">Arithmetic Consequences of Jacobi's Two-Squares Theorem</a>","M. D. Hirschhorn, <a href=\"http://dx.doi.org/10.1016/j.disc.2004.08.045\">The number of representations of a number by various forms</a>, Discrete Mathematics 298 (2005), 205-211.","Christian Kassel, Christophe Reutenauer, <a href=\"http://arxiv.org/abs/1603.06357\">The Fourier expansion of eta(z)eta(2z)eta(3z)/eta(6z)</a>, arXiv:1603.06357 [math.NT], 2016.","Y. Martin, <a href=\"http://dx.doi.org/10.1090/S0002-9947-96-01743-6\">Multiplicative eta-quotients</a>, Trans. Amer. Math. Soc. 348 (1996), no. 12, 4825-4856, see page 4852 Table I.","G. Nebe and N. J. A. Sloane, <a href=\"http://www.math.rwth-aachen.de/~Gabriele.Nebe/LATTICES/D2.html\">Home page for this lattice</a>","F. Richman, <a href=\"http://www.math.fau.edu/Richman/gausdisk.htm\">Counting Gaussian integers in a disk</a>","N. J. A. Sloane et al., <a href=\"https://oeis.org/wiki/Binary_Quadratic_Forms_and_OEIS\">Binary Quadratic Forms and OEIS</a> (Index to related sequences, programs, references)","Michael Somos, <a href=\"/A030203/a030203.txt\">Index to Yves Martin's list of 74 multiplicative eta-quotients and their A-numbers</a>","M. Somos, <a href=\"http://somos.crg4.com/multiq.html\">Introduction to Ramanujan theta functions</a>","G. Villemin, <a href=\"http://villemin.gerard.free.fr/Wwwgvmm/Addition/NoSoCaPr.htm#De1a15\">SOMMES DE 2 CARRES</a>","Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/Barnes-WallLattice.html\">Barnes-Wall Lattice</a>","Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/MoebiusTransform.html\">Moebius Transform</a>","Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/RamanujanThetaFunctions.html\">Ramanujan Theta Functions</a>","Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/SumofSquaresFunction.html\">Sum of Squares Function</a>","Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/ThetaSeries.html\">Theta Series</a>","G. Xiao, <a href=\"http://wims.unice.fr/~wims/en_tool~number~twosquares.en.html\">Two squares</a>","<a href=\"/index/Su#ssq\">Index entries for sequences related to sums of squares</a>","<a href=\"/index/Cor#core\">Index entries for \"core\" sequences</a>"],"formula":"Expansion of theta_3(q)^2 = sum(n=-inf..+inf, q^(n^2) )^2 = prod(m>=1, (1-q^(2*m))^2 * (1+q^(2*m-1))^4 ).Factor n as n = p1^a1 * p2^a2 * ... * q1^b1 * q2^b2 * ... * 2^c, where the p's are primes == 1 mod 4 and the q's are primes == 3 mod 4. Then a(n) = 0 if any b is odd, otherwise a(n) = 4*(1 + a1)*(1 + a2)*...G.f. = s(2)^10/(s(1)^4*s(4)^4), where s(k) := subs(q=q^k, eta(q)) and eta(q) is Dedekind's function, cf. A010815. [Fine]Expansion of eta(q^2)^10 / ( eta(q) * eta(q^4) )^4 in powers of q. - _Michael Somos_, Jul 19 2004Expansion of ( phi(q)^2 + phi(-q)^2 ) / 2 in powers of q^2 where phi() is a Ramanujan theta function.G.f. A(x) satisfies 0 = f(A(x), A(x^2), A(x^4)) where f(u, v, w) = (u - v)^2 - (v - w) * 4 * w. - _Michael Somos_, Jul 19 2004Euler transform of period 4 sequence [ 4, -6, 4, -2, ...]. - _Michael Somos_, Jul 19 2004Moebius transform is period 4 sequence [ 4, 0, -4, 0, ...]. - _Michael Somos_, Sep 17 2007G.f. is a period 1 Fourier series which satisfies f(-1 / (4 t)) = 2 (t/i) f(t) where q = exp(2 Pi i t).The constant sqrt(Pi)/GAMMA(3/4)^2 produces the first 324 terms of the sequence when expanded in base exp(Pi), 450 digits of the constant are necessary. - _Simon Plouffe_, Mar 03 2011a(n) = A004531(4*n). a(n) = 2*A105673(n), if n>0.Dirichlet g.f. sum_{n>=1} a(n)/n^s = 4*zeta(s)*L_(-4)(s), where L is the D.g.f. of the (shifted) A056594. [Raman. J. 7 (2003) 95-127]. - _R. J. Mathar_, Jul 02 2012a(n) = floor(1/(n+1)) + 4*floor(cos(Pi*sqrt(n))^2) - 4*floor(cos(Pi*sqrt(n/2))^2) + 8*sum((floor(cos(Pi*sqrt(i))^2)*floor(cos(Pi*sqrt(n-i))^2)), i=1..floor(n/2)). - _Wesley Ivan Hurt_, Jan 09 2013","example":"G.f. = 1 + 4*q + 4*q^2 + 4*q^4 + 8*q^5 + 4*q^8 + 4*q^9 + 8*q^10 + 8*q^13 + 4*q^16 + 8*q^17 + 4*q^18 + 8*q^20 + 12*q^25 + 8*q^26 + 8*q^29 + 4*q^32 + 8*q^34 + 4*q^36 + 8*q^37 + 8*q^40 + 8*q^41 + 8*q^45 + 4*q^49 + 12*q^50 + 8*q^52 + 8*q^53 + 8*q^58 + 8*q^61 + 4*q^64 + 16*q^65 + 8*q^68 + 4*q^72 + 8*q^73 + 8*q^74 + 8*q^80 + 4*q^81 + 8*q^82 + 16*q^85 + 8*q^89 + 8*q^90 + 8*q^97 + 4*q^98 + 12*q^100 + 8*q^101 + 8*q^104 + 8*q^106 + 8*q^109 + 8*q^113 + ... . - _John Cannon_, Dec 30 2006","maple":"(sum(x^(m^2),m=-10..10))^2;","mathematica":"SquaresR[2,Range[0,110]] (* _Harvey P. Dale_, Oct 10 2011 *)a[ n_] := SquaresR[ 2, n]; (* _Michael Somos_, Nov 15 2011 *)a[ n_] := SeriesCoefficient[ EllipticTheta[ 3, 0, q]^2, {q, 0, n}]; (* _Michael Somos_, Nov 15 2011 *)a[ n_] := With[{m = InverseEllipticNomeQ @ q}, SeriesCoefficient[ EllipticK[ m] / (Pi/2), {q, 0, n}]]; (* _Michael Somos_, Jun 10 2014 *)a[ n_] := If[ n < 1, Boole[n == 0], 4 Sum[ KroneckerSymbol[-4, d], {d, Divisors@n}]]; (* _Michael Somos_, May 17 2015 *)a[ n_] := SeriesCoefficient[ QPochhammer[ q^2]^10/(QPochhammer[ q] QPochhammer[ q^4])^4, {q, 0, n}]; (* _Michael Somos_, May 17 2015 *)","prog":"(PARI) {a(n) = if( n<0, 0, polcoeff( 1 + 4 * sum( k=1, n, x^k / (1 + x^(2*k)), x * O(x^n)), n))};(PARI) {a(n) = if( n<1, n==0, 4 * sumdiv( n, d, (d%4==1) - (d%4==3)))}; /* _Michael Somos_, Jul 19 2004 */(PARI) {a(n) = if( n<1, n==0, 2 * qfrep([ 1, 0; 0, 1], n)[n])}; /* _Michael Somos_, May 13 2005 */(PARI) a(n)=if(n==0,return(1)); my(f=factor(n)); 4*prod(i=1,#f~, if(f[i,1]%4==1, f[i,2]+1, if(f[i,2]%2 && f[i,1]>2, 0, 1))) \\\\ _Charles R Greathouse IV_, Sep 02 2015(MAGMA) Basis( ModularForms( Gamma1(4), 1), 100) [1]; /* _Michael Somos_, Jun 10 2014 */(Sage)Q = DiagonalQuadraticForm(ZZ, [1]*2)Q.representation_number_list(102) # _Peter Luschny_, Jun 20 2014","crossrefs":["Cf. A001481, A004020, A005883, A057655 (partial sums), A057961, A057962. Except for first term, A004018(n)=4*A002654(n). Partial sums - 1 give A014198.","Cf. A104271, A105673.","Cf. A071385 gives records; A071383 gives where records occur."],"keyword":"nonn,easy,nice,core","offset":"0,2","author":"_N. J. A. Sloane_.","extensions":["More terms from _James A. Sellers_, Aug 22 2000","Villemin link fixed by _Robert Munafo_, Dec 14 2009"]}